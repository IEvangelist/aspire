---
import Default from "@astrojs/starlight/components/ContentPanel.astro";

const isHomepage = Astro.locals.starlightRoute.id === "";
---

{
    isHomepage ? (
        <Default><slot /></Default>

        <div class="stars-container">
            <div class="stars stars-small delay-0"></div>
            <div class="stars stars-small delay-2"></div>

            <div class="stars stars-medium delay-1"></div>
            <div class="stars stars-medium delay-3"></div>

            <div class="stars stars-large delay-0"></div>
        </div>

    ) : (
        <Default><slot /></Default>
    )
}

<style>
    :root {
        --star-color-1: rgba(81, 43, 212, 1);
        --star-color-2: rgba(81, 43, 212, 0.9);
        --star-color-3: rgba(81, 43, 212, 0.8);
        --star-color-4: rgba(81, 43, 212, 0.7);

        .card-grid .card {
            border-radius: .5rem;
            background: var(--sl-color-bg-nav);
            z-index: 2;
        }
    }

    :root[data-theme="dark"] {
        --star-color-1: rgba(255, 255, 255, 1);
        --star-color-2: rgba(255, 255, 255, 0.9);
        --star-color-3: rgba(255, 255, 255, 0.8);
        --star-color-4: rgba(255, 255, 255, 0.7);
    }

    :root[data-has-hero] {
        .content-panel {
            background: var(--background-gradient);
        }
    }

    .stars-container {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        overflow: hidden;
        z-index: 0;
        pointer-events: none;
    }

    .stars {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: transparent;
        background-size: 100% 100%;
        opacity: 0;
        animation-timing-function: ease-in-out;
        animation-iteration-count: infinite;
        filter: blur(0.02rem); /* optional glow */
    }

    .delay-0 { animation-delay: 0s; }
    .delay-1 { animation-delay: 2s; }
    .delay-2 { animation-delay: 4s; }
    .delay-3 { animation-delay: 6s; }

    .stars-small {
        background-image: 
            radial-gradient(1px 1px at 10% 10%, var(--star-color-1) 50%, transparent 70%),
            radial-gradient(1px 1px at 25% 15%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 40% 5%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 55% 18%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 70% 8%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 90% 5%, var(--star-color-1) 50%, transparent 70%),
            radial-gradient(1px 1px at 5% 90%, var(--star-color-1) 50%, transparent 70%),
            radial-gradient(1px 1px at 20% 75%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 35% 95%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 60% 82%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 75% 92%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1px 1px at 95% 90%, var(--star-color-1) 50%, transparent 70%);
        background-size: 300px 300px;
        opacity: 0;
        animation: twinkle-small 6s infinite;
    }

    .stars-medium {
        background-image:
            radial-gradient(1.5px 1.5px at 8% 15%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 22% 25%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 45% 5%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 65% 20%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 92% 12%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 12% 88%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 30% 70%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 55% 92%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 72% 85%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(1.5px 1.5px at 85% 82%, var(--star-color-2) 50%, transparent 70%);
        background-size: 400px 400px;
        opacity: 0;
        animation: twinkle-medium 8s infinite 2s;
    }

    .stars-large {
        background-image:
            radial-gradient(2px 2px at 5% 5%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(2px 2px at 28% 12%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(2px 2px at 50% 8%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(2px 2px at 78% 18%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(2px 2px at 95% 5%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(2px 2px at 5% 95%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(2px 2px at 32% 80%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(2px 2px at 60% 90%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(2px 2px at 82% 85%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(2px 2px at 95% 95%, var(--star-color-3) 50%, transparent 70%);
        background-size: 500px 500px;
        opacity: 0;
        animation: twinkle-large 10s infinite 1s;
    }

    @keyframes twinkle-small {
        0%, 100% { opacity: 0; }
        25%, 75% { opacity: 0.4; }
        50% { opacity: 0.6; }
    }

    @keyframes twinkle-medium {
        0%, 100% { opacity: 0; }
        30%, 70% { opacity: 0.3; }
        50% { opacity: 0.5; }
    }

    @keyframes twinkle-large {
        0%, 100% { opacity: 0; }
        20%, 80% { opacity: 0.2; }
        50% { opacity: 0.4; }
    }

    .stars:before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
            circle at 50% 50%,
            transparent 20%,
            var(--hero-bg) 70%
        );
        z-index: 2;
    }
</style>
