---
import Default from "@astrojs/starlight/components/ContentPanel.astro";

const isHomepage = Astro.locals.starlightRoute.id === "";
---

{
    isHomepage ? (
        <Default><slot /></Default>

        <div class="stars-container">
            <div class="stars stars-small delay-0"></div>
            <div class="stars stars-small delay-2"></div>

            <div class="stars stars-medium delay-1"></div>
            <div class="stars stars-medium delay-3"></div>

            <div class="stars stars-large delay-0"></div>
        </div>

    ) : (
        <Default><slot /></Default>
    )
}

<style>
    :root {
        --star-color-1: rgba(81, 43, 212, 1);
        --star-color-2: rgba(81, 43, 212, 0.9);
        --star-color-3: rgba(81, 43, 212, 0.8);
        --star-color-4: rgba(81, 43, 212, 0.7);

        --star-size-1: 1.5px;
        --star-size-2: 2.25px;
        --star-size-3: 3px;

        .card-grid .card {
            border-radius: .5rem;
            background: var(--sl-color-bg-nav);
            z-index: 2;
        }
    }

    :root[data-theme="dark"] {
        --star-color-1: rgba(255, 255, 255, 1);
        --star-color-2: rgba(255, 255, 255, 0.9);
        --star-color-3: rgba(255, 255, 255, 0.8);
        --star-color-4: rgba(255, 255, 255, 0.7);

        --star-size-1: 1px;
        --star-size-2: 1.5px;
        --star-size-3: 2px;
    }

    :root[data-has-hero] {
        .content-panel {
            background: var(--background-gradient);
        }
    }

    .stars-container {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        overflow: hidden;
        z-index: 0;
        pointer-events: none;
    }

    .stars {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: transparent;
        background-size: 100% 100%;
        opacity: 0;
        animation-timing-function: ease-in-out;
        animation-iteration-count: infinite;
        filter: blur(0.02rem); /* optional glow */
    }

    .delay-0 { animation-delay: 0s; }
    .delay-1 { animation-delay: 2s; }
    .delay-2 { animation-delay: 4s; }
    .delay-3 { animation-delay: 6s; }

    .stars-small {
        background-image: 
            radial-gradient(var(--star-size-1) var(--star-size-1) at 10% 10%, var(--star-color-1) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 25% 15%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 40% 5%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 55% 18%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 70% 8%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 90% 5%, var(--star-color-1) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 5% 90%, var(--star-color-1) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 20% 75%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 35% 95%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 60% 82%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 75% 92%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-1) var(--star-size-1) at 95% 90%, var(--star-color-1) 50%, transparent 70%);
        background-size: 300px 300px;
        opacity: 0;
        animation: twinkle-small 6s infinite;
    }

    .stars-medium {
        background-image:
            radial-gradient(var(--star-size-2) var(--star-size-2) at 8% 15%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 22% 25%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 45% 5%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 65% 20%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 92% 12%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 12% 88%, var(--star-color-2) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 30% 70%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 55% 92%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 72% 85%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-2) var(--star-size-2) at 85% 82%, var(--star-color-2) 50%, transparent 70%);
        background-size: 400px 400px;
        opacity: 0;
        animation: twinkle-medium 8s infinite 2s;
    }

    .stars-large {
        background-image:
            radial-gradient(var(--star-size-3) var(--star-size-3) at 5% 5%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 28% 12%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 50% 8%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 78% 18%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 95% 5%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 5% 95%, var(--star-color-3) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 32% 80%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 60% 90%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 82% 85%, var(--star-color-4) 50%, transparent 70%),
            radial-gradient(var(--star-size-3) var(--star-size-3) at 95% 95%, var(--star-color-3) 50%, transparent 70%);
        background-size: 500px 500px;
        opacity: 0;
        animation: twinkle-large 10s infinite 1s;
    }

    @keyframes twinkle-small {
        0%, 100% { opacity: 0; }
        25%, 75% { opacity: 0.4; }
        50% { opacity: 0.6; }
    }

    @keyframes twinkle-medium {
        0%, 100% { opacity: 0; }
        30%, 70% { opacity: 0.3; }
        50% { opacity: 0.5; }
    }

    @keyframes twinkle-large {
        0%, 100% { opacity: 0; }
        20%, 80% { opacity: 0.2; }
        50% { opacity: 0.4; }
    }

    .stars:before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
            circle at 50% 50%,
            transparent 20%,
            var(--hero-bg) 70%
        );
        z-index: 2;
    }

    :root[data-has-hero] {
        .card-grid.stagger .card {
            --sl-card-border: var(--sl-color-purple);
            --sl-card-bg: var(--sl-color-bg-nav);
            border: 1px solid color-mix(in srgb, var(--sl-card-border) 50%, transparent);
            background: var(--sl-color-bg-nav);
            padding: clamp(1rem, calc(.125rem + 3vw), 2.5rem);
            flex-direction: column;
            gap: clamp(.5rem, calc(.125rem + 1vw), 1rem);
        }

        .card-grid.stagger > .card:nth-child(-n+4) {
            border: 1px solid color-mix(in srgb, var(--sl-card-border) 35%, transparent);
            box-shadow: 0 0 8px 0 rgba(var(--sl-color-purple-rgb), 0.07);
        }

        .card-grid.stagger > .card:nth-child(4n+1):nth-child(-n+4) {
            --sl-card-border: var(--sl-color-orange);
            background: 
                radial-gradient(circle at 20% 20%, color-mix(in srgb, var(--sl-card-bg) 85%, var(--sl-card-border)) 0%, var(--sl-card-bg) 35%),
                radial-gradient(circle at 80% 80%, color-mix(in srgb, var(--sl-card-bg) 88%, var(--sl-card-border)) 0%, var(--sl-card-bg) 40%),
                var(--sl-card-bg);
            box-shadow: 0 0 8px 0 rgba(var(--sl-color-orange-rgb), 0.07);
        }

        .card-grid.stagger > .card:nth-child(4n+2):nth-child(-n+4) {
            --sl-card-border: var(--sl-color-purple);
            background: 
                radial-gradient(circle at 75% 25%, color-mix(in srgb, var(--sl-card-bg) 85%, var(--sl-card-border)) 0%, var(--sl-card-bg) 40%),
                radial-gradient(circle at 10% 90%, color-mix(in srgb, var(--sl-card-bg) 88%, var(--sl-card-border)) 0%, var(--sl-card-bg) 35%),
                var(--sl-card-bg);
            box-shadow: 0 0 8px 0 rgba(var(--sl-color-purple-rgb), 0.07);
        }

        .card-grid.stagger > .card:nth-child(4n+3):nth-child(-n+4) {
            --sl-card-border: var(--sl-color-green);
            background: 
                radial-gradient(ellipse at 90% 10%, color-mix(in srgb, var(--sl-card-bg) 85%, var(--sl-card-border)) 0%, var(--sl-card-bg) 50%),
                radial-gradient(ellipse at 30% 70%, color-mix(in srgb, var(--sl-card-bg) 88%, var(--sl-card-border)) 0%, var(--sl-card-bg) 45%),
                var(--sl-card-bg);
            box-shadow: 0 0 8px 0 rgba(var(--sl-color-green-rgb), 0.07);
        }

        .card-grid.stagger > .card:nth-child(4n+4):nth-child(-n+4) {
            --sl-card-border: var(--sl-color-red);
            background: 
                radial-gradient(ellipse at 25% 30%, color-mix(in srgb, var(--sl-card-bg) 85%, var(--sl-card-border)) 0%, var(--sl-card-bg) 40%),
                radial-gradient(circle at 85% 85%, color-mix(in srgb, var(--sl-card-bg) 88%, var(--sl-card-border)) 0%, var(--sl-card-bg) 30%),
                var(--sl-card-bg);
            box-shadow: 0 0 8px 0 rgba(var(--sl-color-red-rgb), 0.07);
        }
    }
</style>
